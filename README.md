# HSP3Service

HSP3Serviceは、HSPでWindowsサービスの作成を可能にするプラグインです。
バックアップソフトやファイル検索ソフトなどのローカルシステム権限が必要な処理、その他各種アプリケーションのサーバープロセスなどユーザーのログオン状況に
影響されないバックグラウンド処理が必要な場合に最適です。

本来、Windowsサービスはコールバック関数やマルチスレッドなどHSPではサポートされていない処理が必要ですが、
それらを実装したDLLを呼び出すことでHSPでもサービスを自作することが可能になります。

このプラグインはシステムから送られてくるサービスコントロール(SC)を中継しウィンドウメッセージとしてHSPアプリケーションに送ります。
従ってHSP3CLなどウィンドウ関連命令が利用できない環境では使用できません。



## インストール方法

Releaseをダウンロード、解凍し次のファイル及びフォルダをHSPがインストールされているディレクトリ
(以下、HSP_root)または下記に対応するサブディレクトリにコピーします。<br>
HSPのヘルプ(HDL)が起動している場合は作業開始前に終了してください。<br>
```
・HSP3Service.dll		        -> HSP_root
・HSP3Service.as		        -> HSP_root\common\
・HSP3Service	          <DIR> -> HSP_root\doclib\
```
使用方法や技術的詳細はインストール後にHDLから閲覧可能になります。



## 動作確認済み環境

- Windows 7, 10, 11
- HSP 3.4, 3.7




## ライセンス

基本的にプラグイン本体は、Microsoft Visual Studio Community 2022 のライセンスに基づくものとし、個人使用の範囲内であれば、改変は自由です。

このプラグインを使用したアプリケーションを配布する場合は、ユーザーは本プラグインを使用していることを当該アプリケーションのReadMeなどに表記することとします。

サンプルスクリプトについては、これを参考に、または改変する形で自由に使用することができます。



## 免責事項

本プラグインの作成者は本プラグインの使用によって発生したいかなる損害についても責任を負わないものとします。


## リンク
- [プログラミング言語 HSP3 公式](https://hsp.tv/)
- [ONION software](https://www.onionsoft.net/)

